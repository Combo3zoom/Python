import re
from Container import Container


def IsIntValue(Value):
    try:
        value = int(Value)
    except TypeError:
        raise TypeError(type(Value) + " is uncorrect type(must be integer)")
    return value


def ExistFile(file):
    try:
        ourFile = open(file)
        ourFile.close()
    except FileNotFoundError:
        raise FileNotFoundError("File does not exist")
    return file


def UserChoose(value):
    try:
        a, b = 0, 7
        if (value == 'exit'):
            return value
        value = int(value)
        if value < a and value > b:
            raise ValueError("User must choose number between 1 to 7 or exit")
    except ValueError as error:
        print(error)
    return value


def IsCategory(category):
    try:
        for i in range(len(Container.dictionary)):
            if category == Container.dictionary[i]:
                return category
        raise ValueError(category + " don't exist")
    except ValueError as error:
        print(error)


def CheckID(ID):
    try:
        if not re.fullmatch(r'[0-9]{0,6}', str(ID)):
            raise ValueError(str(ID) + ' is incorrect ID')
    except ValueError as error:
        print(error)
        return False
    return ID


def CheckName(recipientName):
    try:
        if not re.fullmatch(r'[A-Z][a-z]{2,30}', recipientName):
            raise ValueError(recipientName + ' is incorrect name, name must consists of letters ')
    except ValueError as error:
        print(error)
        return False
    return recipientName


def CheckIban(recipientIban):
    try:
        if not recipientIban[:2] == "UA":
            raise ValueError("the first two letters must begin with UA on IBAN ")
        if not recipientIban[10:15] == "00000":
            raise ValueError("from the tenth to the fifteenth position must contain zeros")
        IsIntValue(recipientIban[15:30])
    except ValueError as error:
        print(error)
        return False
    return recipientIban


def CheckBank(bank):
    try:
        if not re.fullmatch(r'[a-z]{2,30}', str(bank)):
            raise ValueError(bank + ' is incorrect bank, bank consists of letters ')
        rangeBanks = ['privatbank', 'universalbank']
        for i in rangeBanks:
            if bank == i:
                return bank
    except ValueError as error:
        print(error)
        return False

    return


def CheckPaymentType(paymentType):
    try:
        if not re.fullmatch(r'[a-z]{2,30}', str(paymentType)):
            raise ValueError(str(paymentType) + ' is incorrect type, payment type consists of letters ')
        rangePaymentType = ['handle', 'card', 'NFC']
        for i in rangePaymentType:
            if paymentType == i:
                return paymentType
        raise ValueError(paymentType + " isn't payment type")
    except ValueError as error:
        print(error)
        return False


def Amount(amount):
    try:
        if not re.fullmatch(r'[0-9]{1,20}', str(amount)):
            raise ValueError(str(amount) + ' is incorrect amount, amount must be int')
    except ValueError as error:
        print(error)
        return False
    return amount


def CheckMounthDay(value):
    try:
        day, mounth, year = value[0] + value[1], value[3] + value[4], value[6:10]
        day, mounth, year = int(day), int(mounth), int(year)
        if day <= 0 or day >= 32:
            raise ValueError("Day must be value between 1 and 31")
        if mounth <= 0 or mounth >= 13:
            raise ValueError("Mounth must be value between 1 and 12")

        if mounth in (2, 4, 6, 9, 11) and day == 31:
            raise ValueError("Second, fourth, sixth, nineth, eleventh mounth not must be 31 days")
        if mounth == 2:
            if day == 30:
                raise ValueError("Second mounth haven't 30 days")
            if not (year % 400 or (year % 4 == 0 and year % 100 != 0)):
                if day == 29:
                    print("year isn't high")
                    raise ValueError
    except ValueError as error:
        print(error)
        return False
    except TypeError:
        print('Uncorrect type for day/mounth/year')
        return False
    return value


def CheckRandomValue(category, value):
    IsCategory(category)
    if category == Container.dictionary[0]:
        return CheckID(value)
    if category == Container.dictionary[1]:
        return CheckName(value)
    if category == Container.dictionary[2]:
        return CheckIban(value)
    if category == Container.dictionary[3]:
        return CheckBank(value)
    if category == Container.dictionary[4]:
        return CheckPaymentType(value)
    if category == Container.dictionary[5]:
        return Amount(value)
    if category == Container.dictionary[6]:
        return CheckMounthDay(value)
    return
